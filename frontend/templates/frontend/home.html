{% extends 'base/frontendbase.html' %}
{% block content %}

<div id="slideshow">

</div>
{% include 'frontend/about.html' %}

{% include 'frontend/card_articles.html' %}

<div id="events">

</div>

<div id="kingdom-strategies">

</div>
<div id="gallery">

</div>


<script>
    
    {
      (function ($) {
        var pageStatus = null;
        var progress = null;
        var animationInterval = 33;

        window.document.addEventListener("readystatechange", function () {
          if (document.readyState == "complete") {
            pageStatus = "complete";
          }
          else {
            progress++

            $('#progress').progress({
              percent: progress
            });
          }
        }, false);


        function updateProgress() {
          if (pageStatus == "complete") {
            $('#progress').progress({
              percent: 100
            });
            setTimeout(function () {
              $('#page-ready-cover').addClass('uk-transition-fade uk-transition-slow')
              $('#page-ready-cover').transition('fade')
            }, 700);
          }
          else {
            if (progress == null) {
              progress = 1;
            }

            progress = progress + 1;
            if (progress >= 0 && progress <= 30) {
              animationInterval += 1;
              $('#progress').progress({
                percent: progress
              });
            }
            else if (progress > 30 && progress <= 60) {
              animationInterval += 2;
              $('#progress').progress({
                percent: progress
              });
            }
            else if (progress > 60 && progress <= 80) {
              animationInterval += 3;
              $('#progress').progress({
                percent: progress
              });
            }
            else if (progress > 80 && progress <= 90) {
              animationInterval += 4;
              $('#progress').progress({
                percent: progress
              });
            }
            else if (progress > 90 && progress <= 95) {
              animationInterval += 80;
              $('#progress').progress({
                percent: progress
              });
            }
            else if (progress > 95 && progress <= 99) {
              animationInterval += 150;
              document.getElementById("pageLoader").innerHTML = progress;
            }
            else if (progress >= 100) {
              $('#progress').progress({
                percent: progress
              });
            }
            setTimeout(updateProgress, animationInterval);
          }
        }

        var intervalObject_1 = setInterval(function () {
          var element = document.querySelector("body");

          if (element != undefined) {
            clearInterval(intervalObject_1);

            updateProgress();
          }
        }, 50);
        $.ajax({
          beforeSend: function () {
            $('#slideshow').append(inline_loader_small_center);


          },
          complete: function () {
            $('#slideshow').children('.loading').remove()
          },
          type: 'get',
          url: "{% url 'slideshow' %}",
          data: {
            'csrfmiddlewaretoken': window.CSRF_TOKEN, // from index.html
          },
          success: function (response) {
            $('#slideshow').append(response.content);
            progress = 20
            $.ajax({
              beforeSend: function () {
                $('#events').append(inline_loader_small_center);


              },
              complete: function () {
                $('#events').children('.loading').remove()
              },
              type: 'get',
              url: "{% url 'events' %}",
              data: {
                'csrfmiddlewaretoken': window.CSRF_TOKEN, // from index.html
              },
              success: function (response) {
                progress = 40
                $('#events').append(response.content);
                $.ajax({
                  beforeSend: function () {
                    $('#kingdom-strategies').append(inline_loader_small_center);


                  },
                  complete: function () {
                    $('#kingdom-strategies').children('.loading').remove()
                  },
                  type: 'get',
                  url: "{% url 'kingdom_strategies_home' %}",
                  data: {
                    'csrfmiddlewaretoken': window.CSRF_TOKEN, // from index.html
                  },
                  success: function (response) {
                    progress = 60
                    $('#kingdom-strategies').append(response.content);
                    // $('#page-ready-cover').addClass('uk-transition-fade uk-transition-slow')
                    // $('#page-ready-cover').transition('fade')
                    $.ajax({
                      beforeSend: function () {
                        $('#gallery').append(inline_loader_small_center);


                      },
                      complete: function () {
                        $('#gallery').children('.loading').remove()
                      },
                      type: 'get',
                      url: "{% url 'gallery_home' %}",
                      data: {
                        'csrfmiddlewaretoken': window.CSRF_TOKEN, // from index.html
                      },
                      success: function (response) {
                        progress = 100
                        $('#gallery').append(response.content);





                      },
                      error: function (xhr, status, error) {
                        alert('there was an error')
                      }
                    });




                  },
                  error: function (xhr, status, error) {
                    alert('there was an error')
                  }
                });



              },
              error: function (xhr, status, error) {
                alert('there was an error')
              }
            });



          },
          error: function (xhr, status, error) {
            alert('there was an error')
          }
        });
      }(jQuery))
    }

</script>
{% endblock content %}
